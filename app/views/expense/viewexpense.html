<div ng-init="viewexpensedata()" ng-controller="ViewExpenseController">
    <form id="viewExpenseform" name="viewExpenseform" method="post" class="form-horizontal" novalidate>
        <script>
        var currentdate = new Date();
        var firstday = new Date(currentdate.getFullYear(), 0, 1);

        //currentdate.getMonth()
        jQuery.noConflict()(function($) {
            $(document).ready(function() {
                $('#startdate').pickadate({
                    format: 'mm/dd/yyyy',
                    formatSubmit: 'mm/dd/yyyy',
                    editable: false,
                    hiddenName: true,
                    onStart: function() {
                        this.set('select', firstday); // Set to first day of this month 
                    }
                });
                $('#enddate').pickadate({
                    format: 'mm/dd/yyyy',
                    formatSubmit: 'mm/dd/yyyy',
                    hiddenName: true,
                    editable: false,
                    onStart: function() {
                        this.set('select', currentdate); // Set to current date on load
                    }
                });


            });
        });
        </script>
        <div class="row-fluid col-lg-12">
            <div class="row-fluid col-lg-3">
                <h2>View Expense </h2>
                <div class="input-group">
                    <span class="input-group-addon  " id="basic-addon1">Submit date From</span>
                    <input ng-model="startdate" type="text" title="Start Date" class="form-control" name="startdate" id="startdate" ng-required="true" style="background: white" aria-describedby="basic-addon1" />
                </div>
                <div class="input-group">
                    <span class="input-group-addon" id="basic-addon1">To</span>
                    <input ng-model="enddate" type="text" title="End Date" class="form-control" name="enddate" id="enddate" ng-required="true" style="background: white" aria-describedby="basic-addon1" />
                </div>
                <div class="input-group">
                    <span class="input-group-addon" id="basic-addon1">Payment Status</span>
                    <select class="form-control" ng-model="PayStatus" id="PayStatus" name="PayStatus" title="Select Payment Status">
                        <option value="">All</option>
                        <option value="Pending" selected="true">Pending</option>
                        <option value="Approved">Approved</option>
                        <option value="Need Info">Need Info</option>
                    </select>
                </div>
            </div>
            <div class="row-fluid col-lg-3">
                <div class="input-group">
                    <img src="/assets/images/expense/pdf.png" width="40" height="40" title="Create Expense Report" ng-click="CreateExpenseReport()">
                    <a href="#/expense/newexpense" class="btn btn-primary format_button_md" title="Create New Expense">New Expense</a>
                    <a href=" #/expense_QBUpdate " ng-show="userinfo.viewuserdata[0].role =='financemanager'" title="QuickBooks Update">
                        <img src="/assets/images/expense/QuickBooks.png" width="130" height="35" title="Go to QuickBooks Update Page" />
                    </a>
                </div>
            </div>
        </div>
        <div ng-show="userinfo.viewuserdata[0].role !='coordinator' " class=" row-fluid">
            <div class="row-fluid col-lg-12">
                <div class="input-group">
                    <select class="form-control col-xs-4" ng-model="listS" id="selectedchapter" name="selectedchapter" title="Select Chapter Name">
                        <option value="" selected="true">All -Chapters</option>
                        <option ng-repeat="chapter in lists.viewExpenseList | unique:'Chapter'" value="{{chapter.Chapter}}">{{chapter.Chapter}}</option>
                    </select>
                </div>
                <div class="input-group">
                    <table class="table table-bordered table-condensed display nowrap" id="tblexpenselist" width="100%">
                        <thead class="table_head ">
                            <tr>
                                <th>
                                    <a ng-click="sortBy='SubmitDate' ; sortDescending=! sortDescending ">Submit Date </a>
                                    <span ng-show="sortBy=='SubmitDate' && !sortDescending " class="glyphicon glyphicon-chevron-down "></span>
                                    <span ng-show="sortBy=='SubmitDate' && sortDescending " class="glyphicon glyphicon-chevron-up "></span>
                                </th>
                                <th>
                                    <a ng-click="sortBy='Chapter' ; sortDescending=! sortDescending ">Chapter Name </a>
                                    <span ng-show="sortBy=='Chapter' && !sortDescending " class="glyphicon glyphicon-chevron-down "></span>
                                    <span ng-show="sortBy=='Chapter' && sortDescending " class="glyphicon glyphicon-chevron-up "></span>
                                </th>
                                <th>
                                    <a ng-click="sortBy='eventdate' ; sortDescending=! sortDescending ">Event Date </a>
                                    <span ng-show="sortBy=='eventdate' && !sortDescending " class="glyphicon glyphicon-chevron-down "></span>
                                    <span ng-show="sortBy=='eventdate' && sortDescending " class="glyphicon glyphicon-chevron-up "></span>
                                </th>
                                <th>
                                    <a ng-click="sortBy='Amount' ; sortDescending=! sortDescending ">Amount </a>
                                    <span ng-show="sortBy=='Amount' && !sortDescending " class="glyphicon glyphicon-chevron-down "></span>
                                    <span ng-show="sortBy=='Amount' && sortDescending " class="glyphicon glyphicon-chevron-up "></span>
                                </th>
                                <th>
                                    <a ng-click="sortBy='PaymentStatus' ; sortDescending=! sortDescending ">Payment Status </a>
                                    <span ng-show="sortBy=='PaymentStatus' && !sortDescending " class="glyphicon glyphicon-chevron-down "></span>
                                    <span ng-show="sortBy=='PaymentStatus' && sortDescending " class="glyphicon glyphicon-chevron-up "></span>
                                </th>
                            </tr>
                        </thead>
                        <tbody ng-repeat="list in lists.viewExpenseList |   orderBy:sortBy:sortDescending|  filter: {Chapter: listS} | filter: {PaymentStatus: PayStatus} | dateRange: startdate : enddate" ng-click="setSelected(list.BillId)" ng-class="{selected: list.BillId === idSelectedBill}">
                            <tr class="hoverme">
                                <td class="col-md-2 "> <a href="#/expense/expensedetail/{{list.BillId}} "> {{list.SubmitDate}} </a></td>
                                <td class="col-md-4 "> <a href="#/expense/expensedetail/{{list.BillId}} ">{{list.Chapter}}</a></td>
                                <td class="col-md-2 "> <a href="#/expense/expensedetail/{{list.BillId}} ">{{list.eventdate}} </a></td>
                                <td class="col-md-2 " style="text-align: right "><a href="#/expense/expensedetail/{{list.BillId}} ">{{list.Amount | currency:'$'}} </a></td>
                                <!--td class="col-md-4 ">{{list.Description}}</td-->
                                <td class="col-md-2 " ng-class="{ 'color-green': list.PaymentStatus==='Approved' , 'color-red': list.PaymentStatus==='Pending' , 'color-orange': list.PaymentStatus==='Need Info' } ">
                                    <a href="#/expense/expensedetail/{{list.BillId}} "> <b>{{list.PaymentStatus}} </b></a>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <div ng-show="userinfo.viewuserdata[0].role=='coordinator' ">
            <div class="form-group col-xs-12 ">
                <div class="form-group col-xs-5 ">
                    <label for=" ">Co-ordinator Name</label>
                    <select class="form-control" required=" " ng-model="userlist " id="selectedcoordinator" name="selectedcoordinator" title="Select Coordinator Name ">
                        <option value=" " selected="true ">All Coordinator</option>
                        <option ng-repeat="coord in lists.viewExpenseList | unique: 'SubmitBy' | filter: {Chapter: userinfo.viewuserdata[0].Chapter} " value="{{coord.SubmitBy}} ">{{coord.SubmitBy}}
                        </option>
                    </select>
                </div>
            </div>
            <table class="table table-bordered table-condensed display nowrap" id="tblexpenselist" cellspacing="0" width="100%">
                <thead class="table_head ">
                    <tr>
                        <th>
                            <a ng-click="sortBy='SubmitDate' ; sortDescending=! sortDescending ">Submit Date </a>
                            <span ng-show="sortBy=='SubmitDate' && !sortDescending " class="glyphicon glyphicon-chevron-down "></span>
                            <span ng-show="sortBy=='SubmitDate' && sortDescending " class="glyphicon glyphicon-chevron-up "></span>
                        </th>
                        <th>
                            <a ng-click="sortBy='SubmitBy' ; sortDescending=! sortDescending ">Coordinator Name </a>
                            <span ng-show="sortBy=='SubmitBy' && !sortDescending " class="glyphicon glyphicon-chevron-down "></span>
                            <span ng-show="sortBy=='SubmitBy' && sortDescending " class="glyphicon glyphicon-chevron-up "></span>
                        </th>
                        <th>
                            <a ng-click="sortBy='eventdate' ; sortDescending=! sortDescending ">Event Date </a>
                            <span ng-show="sortBy=='eventdate' && !sortDescending " class="glyphicon glyphicon-chevron-down "></span>
                            <span ng-show="sortBy=='eventdate' && sortDescending " class="glyphicon glyphicon-chevron-up "></span>
                        </th>
                        <th>
                            <a ng-click="sortBy='Amount' ; sortDescending=! sortDescending ">Amount </a>
                            <span ng-show="sortBy=='Amount' && !sortDescending " class="glyphicon glyphicon-chevron-down "></span>
                            <span ng-show="sortBy=='Amount' && sortDescending " class="glyphicon glyphicon-chevron-up "></span>
                        </th>
                        <th>
                            <a ng-click="sortBy='PaymentStatus' ; sortDescending=! sortDescending ">Payment Status </a>
                            <span ng-show="sortBy=='PaymentStatus' && !sortDescending " class="glyphicon glyphicon-chevron-down "></span>
                            <span ng-show="sortBy=='PaymentStatus' && sortDescending " class="glyphicon glyphicon-chevron-up "></span>
                        </th>
                    </tr>
                </thead>
                <tbody ng-repeat="coord in lists.viewExpenseList | orderBy:sortBy:sortDescending | filter: {SubmitBy: userlist} | filter: {PaymentStatus: PayStatus} | filter: {Chapter: userinfo.viewuserdata[0].Chapter} | dateRange: startdate : enddate " ng-click="setSelected(coord.BillId) " ng-class="{selected: coord.BillId===idSelectedBill} ">
                    <tr class="hoverme ">
                        <td class="col-md-2 "> <a href="#/expense_detail/{{coord.BillId}} ">{{coord.SubmitDate}} </a></td>
                        <td class="col-md-3 "> <a href="#/expense_detail/{{coord.BillId}} ">{{coord.SubmitBy}}</a> </td>
                        <td class="col-md-2 "> <a href="#/expense_detail/{{coord.BillId}} "><a href="#/expense_detail/{{coord.BillId}} ">{{coord.eventdate}} </a></td>
                        <td class="col-md-2 " style="text-align: right ">{{coord.Amount | currency:'$'}} </td>
                        <td class="col-md-2 " ng-class="{ 'color-green': list.PaymentStatus==='Approved' , 'color-red': list.PaymentStatus==='Pending' , 'color-orange': list.PaymentStatus==='Need Info' } ">
                            <b>{{coord.PaymentStatus}} </b>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
</div>
</form>
</div>
